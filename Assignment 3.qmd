---
title: "Assignment 3"
author: "Pierre-Olivier Couture"
format: html
editor: visual
---

## Assignment 3

This is all the code I used for Assignment 3

```{r}
#| label: Packages
# This section of code installs and initializes all the packages I will use throughout the assignment. The flexplot packages was "#" out because it kept asking me for updates and will not let me render into a html file. The code still works fine with this adjustment since the package is already installed on R. 
library(lme4)
options(repos = c(CRAN = "https://cran.rstudio.com/"))

#install.packages("remotes")

#remotes::install_github("dustinfife/flexplot")

install.packages("apaTables")

library(haven)
library(flexplot)
library(tidyverse)
library(dplyr)
library(flexplot)
library(apaTables)

```

```{r}
#| label: Load in the data
# This section of code loads in the data and cleans the names to remove all capital letters to make it easier when I need to call on the variables throughout my code. 

A4 <- read_sav("~/Desktop/P6003.A4.sav") %>% 
  clean_names()
View(A4)

```

```{r}
#| label: Correlation table
# I used this section of code to create a data frame that includes all the variables and makes it easier for me to report the descriptive statistics. Could include them in a table if I have time to look at the correct code to do this since the apaTables package does not have a code to report descriptive statistics and I would need to find more background information.  

describe_vars <- A4 %>% select(swl, tipm_e, tipm_n)
psych::describe(describe_vars)

# This part of the code will provide me with the correlation between all the variables using only the rows with no missing data for the variables I am interested in. This will only not include variables if any of the variables have missing data for the variables of interest.

cor(describe_vars, use = "pairwise")
apa.cor.table(describe_vars, filename = "Correlation Matrix of Satisfaction with Life, Extraversion, and Neuroticism.doc", table.number = 1)


```

```{r}
#| label: H1 Code
# This is the code I will use to test all assumptions and calculate all the data needed for H1. 

# Step 1: Creating the regression model
H1 <- lm(swl ~ tipm_e, data = A4)

# Step 2: Visualize the model
visualize(H1, plot = "residuals")

# Step 3: Model Output for H2
estimates(H1)
summary(H1)

# Step 4: Extract residuals for further assumption checks
residuals_H1 <- residuals(H1)

# Step 5: Check for independence of observations (ACF plot for residuals)
# Using this to examine the independence of observations since the data was collected over several time points. 
acf(residuals_H1)

# Step 6: Visualize the relationship between swl and tipm_e using flexplot
# Since I have checked the assumptions above, this code will provide me with a linear regression model of the relationship between swl and tipm_e and allows me to visualize the relationship.
flexplot(swl ~ tipm_e, data = A4)

```
The code above does an assumption check for H1 and creates a model for H1. Below is my interpretation of everything to help me with the write-up later.  

-- The Histogram of Residuals shows that the residuals are approximately normally distributed but with a slight left skew.If this is the only violation of the assumptions, the model is still considered reliable. However, if other assumptions are also violated, the model may not be valid. NORMALITY of RESIDUALS assumption is met. 

-- The RDP is flat meaning this assumption is met. LINEARITY assumption is met.

-- The S-L Plot is relatively flat and straight meaning this assumption is met. HOMOSKEDACITY assumption is met.

-- The ACF plot shows that several of the lines extend past the 95% CI range meaning that the residuals at one time point seem to be related to the residuals from previous time points. The assumption is not met. INDEPENDENCE of OBSERVATIONS assumption NOT met.

-- Multicolinearity was not assessed since I was only using 1 predictor and this cannot be calculated. So multicolinearity is not an issue in H1. 

All I need to do is mention that the independence of observations assumption is violated and that I would conduct a mixed-effects model to model the temporal dependencies between observations. *** ASKED ASHLEY IF THIS NEEDED TO BE INCLUDED OR IF I CAN JUST MENTION IT ***

Using the estimate and summary function here are the findings to make it easier to write about in the Word doc.

Estimate for tipm_e = 0.40 meaning the association is positive and this is considered a moderate association.
-- The 95% CI are 0.37 and 0.43. Since these do not cross 0 we can say this association is statistically significant. The CI also have a small margin of error so we can say the estimate is relatively precise. 
-- The standardized estimate is 0.38 with the CIs of 0.35 and 0.41 further supporting that there is a moderate, positive association between extraversion and satisfaction with life
-- Multiple R^2 is 0.1441 and the adjusted R^2 is 0.1439.
---- Multiple R^2 suggests that 14.41% of the variance in satisfaction with life is explained by extraversion. Given this number is quite small, we can assume that other predictors influence this association. 
---- Semi-Partial R^2 indicates the unique proportion of variance in satisfaction with life that is explained by extraversion alone, excluding other potential predictors. 0.144 suggests a moderate, positive relationship between extraversion and satisfaction with life, meaning extraversion has a meaningful effect on satisfaction with life. 

```{r}
#| label: H2 Code
# This is the code I will use to test all assumptions and calculate all the data needed for H2.

# Step 1: Creating the regression model
H2 <- lm(swl ~ tipm_n, data = A4)

# Step 2: Visualize the residuals for the model
visualize(H2, plot = "residuals")

# Step 3: Model Output for H2
estimates(H2)
summary(H2)

# Step 4: Extract residuals for further assumption checks
residuals_H2 <- residuals(H2)

# Step 5: Check for independence of observations (ACF plot for residuals)
# Using this to examine the independence of observations since the data was collected over several time points.
acf(residuals_H2)

# Step 6: Visualize the relationship between swl and tipm_n using flexplot
# Since I have checked the assumptions above, this code will provide me with a linear regression model of the relationship between swl and tipm_n and allows me to visualize the relationship.
flexplot(swl ~ tipm_n, data = A4)

```
The code above does an assumption check for H2 and creates a model for H1. Below is my interpretation of everything to help me with the write-up later.  

-- The Histogram of Residuals shows that the residuals are approximately normally distributed but with a slight left skew.If this is the only violation of the assumptions, the model is still considered reliable. However, if other assumptions are also violated, the model may not be valid. NORMALITY of RESIDUALS assumption is met. 

-- The RDP is is slightly curved at the both ends with a tip about 3/4 of the way into the line. From the previous assignment Ashley said you're good to just mention it appears to be violated and that a quadratic or other model may be a better fit and move along as if the assumption was met! However, make sure to include in the results that results need to be interpreted with caution given the issue with linearity. LINEARITY assumption NOT met. 

-- The S-L Plot is relatively flat and straight meaning this assumption is met. HOMOSKEDACITY assumption is met.

-- The ACF plot shows that several of the lines extend past the 95% CI range meaning that the residuals at one time point seem to be related to the residuals from previous time points. The assumption is not met. INDEPENDENCE of OBSERVATIONS assumption NOT met.

-- Multicolinearity was not assessed since I was only using 1 predictor and this cannot be calculated. So multicolinearity is not an issue in H1. 

All I need to do is mention that the independence of observations assumption is violated and that I would conduct a mixed-effects model to model the temporal dependencies between observations. *** ASKED ASHLEY IF THIS NEEDED TO BE INCLUDED OR IF I CAN JUST MENTION IT ***

Using the estimate and summary function here are the findings to make it easier to write about in the Word doc.

Estimate for tipm_n = -0.47, meaning the association is negative and this is considered a moderate association. 
-- The 95% CI are -0.50 and -0.44. Since these do not cross 0, we can say this association is statistically significant. The CI also has a small margin of error, so we can say the estimate is relatively precise. 
-- The standardized estimate is -0.45 with the CIs of -0.48 and -0.42, further supporting that there is a moderate, negative association between neuroticism and satisfaction with life.
-- Multiple R² is 0.2035, and the adjusted R² is 0.2033. 
---- Multiple R² suggests that 20.35% of the variance in satisfaction with life is explained by neuroticism. Given this number is quite small, we can assume that other predictors influence this association. 
---- Semi-Partial R² indicates the unique proportion of variance in satisfaction with life that is explained by neuroticism alone, excluding other potential predictors. 0.144 suggests a moderate, negative relationship between neuroticism and satisfaction with life, meaning neuroticism has a meaningful effect on satisfaction with life.

```{r}
#| label: H3 Code
# This is the code I will use to test all assumptions and calculate all the data needed for H3.

# Step 1: Creating the multilevel regression model with both Extraversion (tipm_e) and Neuroticism (tipm_n)
H3 <- lm(swl ~ tipm_e + tipm_n, data = A4)

# Step 2: Visualize the residuals for the model
visualize(H3, plot = "residuals")

# Step 3: Model Output for H3
estimates(H3)
summary(H3)

# Step 4: Extract residuals for further assumption checks
residuals_H3 <- residuals(H3)

# Step 5: Check for independence of observations (ACF plot for residuals)
# Using this to examine the independence of observations since the data was collected over several time points.
acf(residuals_H3)

# Step 6: Visualize the relationship between swl and both tipm_e and tipm_n using flexplot
# Since I have checked the assumptions above, this code will provide me with a linear regression model of the relationship between swl, tipm_e, and tipm_n and allows me to visualize the relationship.
flexplot(swl ~ tipm_e + tipm_n, data = A4)



```









The `echo: false` option disables the printing of code (only output is displayed).
